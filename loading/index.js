/**
 * @param {object} option 可直接传dom节点,也可为对象
 * @param {object} container 想要挂载loading的容器
 * @param {int} timeout 超时时间
 * 
 */
class loading {
    constructor(option) {
        this.timeoutObj = null;
        this._container = option.nodeName || option instanceof NodeList ? option : option.container;
        this._time = option.timeout || 10000;
    }
    create(container) {
        if (typeof container === 'undefined' || !container.querySelector('.loading')) {
            let loading = document.createElement('div'),
                mask = document.createElement('div'),
                image = document.createElement('img');
            loading.classList.add('mui-loading');
            image.classList.add('loading-icon');
            image.src = 'data:image/gif;base64,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';
            loading.appendChild(image);
            mask.classList.add('mui-loading-mask');
            loading.appendChild(mask);
            if (!container || (container && !container.nodeName)) {
                container = document.querySelector('body');
                loading.classList.add('all');
                mask.classList.add('all');
            }
            container.appendChild(loading);
            if (!['fixed', 'absolute', 'relative'].some((value)=>container.style.position == value)) {
                container.style.position = 'relative';
            }
            if (this.loading instanceof Array) {
                this.loading.push(loading);
            } else if (this.loading) {
                let temp = this.loading;
                this.loading = [temp, loading];
            } else {
                this.loading = loading;
                this.mask = mask;
                this.image = image;
            }
            this.timeOut();
        }
    }
    show() {
        if (this._container instanceof NodeList) {
            for (let i = 0;i < this._container.length;i++) {
                this.create(this._container[i]); 
            }
        } else {
            this.create(this._container); 
        }
        return this;
    }
    hide() {
        if (this.loading) {
            clearTimeout(this.timeoutObj);
            if (this.loading instanceof Array) {
                for (let i = 0;i < this.loading.length;i++) {
                    this.loading[i].parentNode && this.loading[i].parentNode.removeChild(this.loading[i]);
                }
            } else {
                this.loading.parentNode && this.loading.parentNode.removeChild(this.loading);
            }
        }
    }
    timeOut() {
        this.timeoutObj = setTimeout(this.hide.bind(this), this._time);
    }
}

module.exports = loading;